{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/goods.js"
    ],
    "names": [
        "Base",
        "require",
        "moment",
        "fs",
        "path",
        "qiniu",
        "module",
        "exports",
        "indexAction",
        "page",
        "get",
        "size",
        "name",
        "model",
        "data",
        "where",
        "is_delete",
        "order",
        "countSelect",
        "item",
        "info",
        "id",
        "category_id",
        "find",
        "category_name",
        "is_on_sale",
        "is_index",
        "product",
        "goods_id",
        "select",
        "ele",
        "spec",
        "goods_specification_ids",
        "value",
        "success",
        "getExpressDataAction",
        "kd",
        "cate",
        "kdData",
        "push",
        "label",
        "cateData",
        "parent_id",
        "infoData",
        "copygoodsAction",
        "goodsId",
        "post",
        "insertId",
        "add",
        "goodsGallery",
        "gallery",
        "img_url",
        "sort_order",
        "updateStock",
        "goods_sn",
        "goods_number",
        "console",
        "log",
        "update",
        "updateGoodsNumberAction",
        "all_goods",
        "goodsSum",
        "sum",
        "think",
        "timeout",
        "onsaleAction",
        "outAction",
        "dropAction",
        "sortAction",
        "index",
        "saleStatusAction",
        "status",
        "sale",
        "checked",
        "productStatusAction",
        "indexShowStatusAction",
        "stat",
        "infoAction",
        "getAllSpecificationAction",
        "specInfo",
        "specOptionsData",
        "spitem",
        "getAllCategory1Action",
        "is_show",
        "level",
        "c_data",
        "newData",
        "children",
        "citem",
        "getAllCategoryAction",
        "field",
        "c_item",
        "storeAction",
        "values",
        "specData",
        "specValue",
        "cateId",
        "picUrl",
        "list_pic_url",
        "is_new",
        "freight_template_id",
        "product_id",
        "retail_price",
        "goods_specifition_name_value",
        "specificationData",
        "specification_id",
        "specId",
        "pro",
        "length",
        "goodsNum",
        "getField",
        "maxPrice",
        "Math",
        "max",
        "minPrice",
        "min",
        "cost",
        "maxCost",
        "minCost",
        "goodsPrice",
        "costPrice",
        "cost_price",
        "min_retail_price",
        "min_cost_price",
        "updatePriceAction",
        "checkSkuAction",
        "isEmpty",
        "fail",
        "updateSortAction",
        "sort",
        "updateShortNameAction",
        "short_name",
        "galleryListAction",
        "galleryAction",
        "url",
        "getGalleryListAction",
        "galleryData",
        "pdata",
        "deleteGalleryFileAction",
        "limit",
        "galleryEditAction",
        "isPost",
        "parseInt",
        "deleteListPicUrlAction",
        "destoryAction",
        "uploadHttpsImageAction",
        "accessKey",
        "config",
        "secretKey",
        "domain",
        "mac",
        "auth",
        "digest",
        "Mac",
        "conf",
        "Config",
        "zoneNum",
        "zone",
        "Zone_z0",
        "Zone_z1",
        "Zone_z2",
        "Zone_na0",
        "Zone_as0",
        "bucketManager",
        "rs",
        "BucketManager",
        "bucket",
        "key",
        "uuid",
        "uploadQiniu",
        "Promise",
        "resolve",
        "reject",
        "fetch",
        "err",
        "respBody",
        "respInfo",
        "statusCode",
        "e",
        "httpsUrl",
        "lastUrl"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/goods.js",
    "sourcesContent": [
        "const Base = require('./base.js');\nconst moment = require('moment');\nconst fs = require('fs');\nconst path = require(\"path\");\nconst qiniu = require('qiniu');\nmodule.exports = class extends Base {\n    /**\n     * index action\n     * @return {Promise} []\n     */\n    async indexAction() {\n        const page = this.get('page') || 1;\n        const size = this.get('size') || 50;\n        const name = this.get('name') || '';\n        const model = this.model('goods');\n        const data = await model.where({\n            name: ['like', `%${name}%`],\n            is_delete: 0\n        }).order(['sort_order asc']).page(page, size).countSelect();\n        // let newData = data;\n        for (const item of data.data) {\n            const info = await this.model('category').where({\n                id: item.category_id\n            }).find();\n            item.category_name = info.name;\n            if (item.is_on_sale == 1) {\n                item.is_on_sale = true;\n            } else {\n                item.is_on_sale = false;\n            }\n            if (item.is_index == 1) {\n                item.is_index = true;\n            } else {\n                item.is_index = false;\n            }\n            let product = await this.model('product').where({\n                goods_id: item.id,\n                is_delete: 0\n            }).select();\n            for (const ele of product) {\n                let spec = await this.model('goods_specification').where({\n                    id: ele.goods_specification_ids,\n                    is_delete: 0\n                }).find();\n                ele.value = spec.value;\n                ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\n            }\n            item.product = product;\n        }\n        return this.success(data);\n    }\n    async getExpressDataAction() {\n        let kd = [];\n        let cate = [];\n        const kdData = await this.model('freight_template').where({\n            is_delete: 0\n        }).select();\n        for (const item of kdData) {\n            kd.push({\n                value: item.id,\n                label: item.name\n            })\n        }\n        const cateData = await this.model('category').where({\n            parent_id: 0\n        }).select();\n        for (const item of cateData) {\n            cate.push({\n                value: item.id,\n                label: item.name\n            })\n        }\n        let infoData = {\n            kd: kd,\n            cate: cate\n        };\n        return this.success(infoData);\n    }\n    async copygoodsAction() {\n        const goodsId = this.post('id');\n        let data = await this.model('goods').where({\n            id: goodsId\n        }).find();\n        delete data.id;\n        data.is_on_sale = 0;\n        let insertId = await this.model('goods').add(data);\n        let goodsGallery = await this.model('goods_gallery').where({\n            goods_id: goodsId,\n            is_delete:0,\n        }).select();\n        for (const item of goodsGallery) {\n            let gallery = {\n                img_url: item.img_url,\n                sort_order: item.sort_order,\n                goods_id: insertId\n            }\n            await this.model('goods_gallery').add(gallery);\n        }\n        return this.success(insertId);\n    }\n    async updateStock(goods_sn, goods_number) {\n        console.log('存在，现在就更新');\n        await this.model('product').where({\n            goods_sn: goods_sn\n        }).update({\n            goods_number: goods_number\n        });\n    }\n    async updateGoodsNumberAction() {\n        let all_goods = await this.model('goods').where({\n            is_delete: 0,\n            is_on_sale: 1\n        }).select();\n        for (const item of all_goods) {\n            let goodsSum = await this.model('product').where({\n                goods_id: item.id\n            }).sum('goods_number');\n            await this.model('goods').where({\n                id: item.id\n            }).update({\n                goods_number: goodsSum\n            });\n            await think.timeout(2000);\n        }\n        return this.success();\n    }\n    async onsaleAction() {\n        const page = this.get('page') || 1;\n        const size = this.get('size') || 50;\n        const model = this.model('goods');\n        const data = await model.where({\n            is_delete: 0,\n            is_on_sale: 1\n        }).order(['sort_order asc']).page(page, size).countSelect();\n        for (const item of data.data) {\n            const info = await this.model('category').where({\n                id: item.category_id\n            }).find();\n            item.category_name = info.name;\n            // if (info.parent_id != 0) {\n            //     const parentInfo = await this.model('category').where({id: info.parent_id}).find();\n            //     item.category_p_name = parentInfo.name;\n            // }\n            if (item.is_on_sale == 1) {\n                item.is_on_sale = true;\n            } else {\n                item.is_on_sale = false;\n            }\n            if (item.is_index == 1) {\n                item.is_index = true;\n            } else {\n                item.is_index = false;\n            }\n            let product = await this.model('product').where({\n                goods_id: item.id,\n                is_delete: 0\n            }).select();\n            for (const ele of product) {\n                let spec = await this.model('goods_specification').where({\n                    id: ele.goods_specification_ids,\n                    is_delete: 0\n                }).find();\n                ele.value = spec.value;\n                ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\n            }\n            item.product = product;\n        }\n        return this.success(data);\n    }\n    async outAction() {\n        const page = this.get('page') || 1;\n        const size = this.get('size') || 50;\n        const model = this.model('goods');\n        const data = await model.where({\n            is_delete: 0,\n            goods_number: ['<=', 0]\n        }).order(['sort_order asc']).page(page, size).countSelect();\n        for (const item of data.data) {\n            const info = await this.model('category').where({\n                id: item.category_id\n            }).find();\n            item.category_name = info.name;\n            if (item.is_on_sale == 1) {\n                item.is_on_sale = true;\n            } else {\n                item.is_on_sale = false;\n            }\n            if (item.is_index == 1) {\n                item.is_index = true;\n            } else {\n                item.is_index = false;\n            }\n            let product = await this.model('product').where({\n                goods_id: item.id,\n                is_delete: 0\n            }).select();\n            for (const ele of product) {\n                let spec = await this.model('goods_specification').where({\n                    id: ele.goods_specification_ids,\n                    is_delete: 0\n                }).find();\n                ele.value = spec.value;\n                ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\n            }\n            item.product = product;\n        }\n        return this.success(data);\n    }\n    async dropAction() {\n        const page = this.get('page') || 1;\n        const size = this.get('size') || 50;\n        const model = this.model('goods');\n        const data = await model.where({\n            is_delete: 0,\n            is_on_sale: 0\n        }).order(['id DESC']).page(page, size).countSelect();\n        for (const item of data.data) {\n            const info = await this.model('category').where({\n                id: item.category_id\n            }).find();\n            item.category_name = info.name;\n            if (item.is_on_sale == 1) {\n                item.is_on_sale = true;\n            } else {\n                item.is_on_sale = false;\n            }\n            if (item.is_index == 1) {\n                item.is_index = true;\n            } else {\n                item.is_index = false;\n            }\n            let product = await this.model('product').where({\n                goods_id: item.id,\n                is_delete: 0\n            }).select();\n            for (const ele of product) {\n                let spec = await this.model('goods_specification').where({\n                    id: ele.goods_specification_ids,\n                    is_delete: 0\n                }).find();\n                ele.value = spec.value;\n                ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\n            }\n            item.product = product;\n        }\n        return this.success(data);\n    }\n    async sortAction() {\n        const page = this.get('page') || 1;\n        const size = this.get('size') || 50;\n        const model = this.model('goods');\n        const index = this.get('index');\n        if (index == 1) {\n            const data = await model.where({\n                is_delete: 0\n            }).order(['sell_volume DESC']).page(page, size).countSelect();\n            for (const item of data.data) {\n                const info = await this.model('category').where({\n                    id: item.category_id\n                }).find();\n                item.category_name = info.name;\n                if (item.is_on_sale == 1) {\n                    item.is_on_sale = true;\n                } else {\n                    item.is_on_sale = false;\n                }\n                if (item.is_index == 1) {\n                    item.is_index = true;\n                } else {\n                    item.is_index = false;\n                }\n                let product = await this.model('product').where({\n                    goods_id: item.id,\n                    is_delete: 0\n                }).select();\n                for (const ele of product) {\n                    let spec = await this.model('goods_specification').where({\n                        id: ele.goods_specification_ids,\n                        is_delete: 0\n                    }).find();\n                    ele.value = spec.value;\n                    ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\n                }\n                item.product = product;\n            }\n            return this.success(data);\n        } else if (index == 2) {\n            const data = await model.where({\n                is_delete: 0\n            }).order(['retail_price DESC']).page(page, size).countSelect();\n            for (const item of data.data) {\n                const info = await this.model('category').where({\n                    id: item.category_id\n                }).find();\n                item.category_name = info.name;\n                if (item.is_on_sale == 1) {\n                    item.is_on_sale = true;\n                } else {\n                    item.is_on_sale = false;\n                }\n                if (item.is_index == 1) {\n                    item.is_index = true;\n                } else {\n                    item.is_index = false;\n                }\n                let product = await this.model('product').where({\n                    goods_id: item.id,\n                    is_delete: 0\n                }).select();\n                for (const ele of product) {\n                    let spec = await this.model('goods_specification').where({\n                        id: ele.goods_specification_ids,\n                        is_delete: 0\n                    }).find();\n                    ele.value = spec.value;\n                    ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\n                }\n                item.product = product;\n            }\n            return this.success(data);\n        } else if (index == 3) {\n            const data = await model.where({\n                is_delete: 0\n            }).order(['goods_number DESC']).page(page, size).countSelect();\n            for (const item of data.data) {\n                const info = await this.model('category').where({\n                    id: item.category_id\n                }).find();\n                item.category_name = info.name;\n                if (item.is_on_sale == 1) {\n                    item.is_on_sale = true;\n                } else {\n                    item.is_on_sale = false;\n                }\n                if (item.is_index == 1) {\n                    item.is_index = true;\n                } else {\n                    item.is_index = false;\n                }\n                let product = await this.model('product').where({\n                    goods_id: item.id,\n                    is_delete: 0\n                }).select();\n                for (const ele of product) {\n                    let spec = await this.model('goods_specification').where({\n                        id: ele.goods_specification_ids,\n                        is_delete: 0\n                    }).find();\n                    ele.value = spec.value;\n                    ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\n                }\n                item.product = product;\n            }\n            return this.success(data);\n        }\n    }\n    async saleStatusAction() {\n        const id = this.get('id');\n        const status = this.get('status');\n        let sale = 0;\n        if (status == 'true') {\n            sale = 1;\n        }\n        const model = this.model('goods');\n        await model.where({\n            id: id\n        }).update({\n            is_on_sale: sale\n        });\n        await this.model('cart').where({\n            goods_id: id\n        }).update({\n            is_on_sale: sale,\n            checked: sale\n        });\n    }\n    async productStatusAction() {\n        const id = this.get('id');\n        const status = this.get('status');\n        const model = this.model('product');\n        await model.where({\n            id: id\n        }).update({\n            is_on_sale: status\n        });\n    }\n    async indexShowStatusAction() {\n        const id = this.get('id');\n        const status = this.get('status');\n        let stat = 0;\n        if (status == 'true') {\n            stat = 1;\n        }\n        const model = this.model('goods');\n        await model.where({\n            id: id\n        }).update({\n            is_index: stat\n        });\n    }\n    async infoAction() {\n        const id = this.get('id');\n        const model = this.model('goods');\n        const data = await model.where({\n            id: id\n        }).find();\n        let category_id = data.category_id;\n        let infoData = {\n            info: data,\n            category_id: category_id,\n        };\n        return this.success(infoData);\n    }\n    async getAllSpecificationAction() {\n        const specInfo = await this.model('specification').where({\n            id: ['>', 0]\n        }).select();\n        let specOptionsData = [];\n        for (const spitem of specInfo) {\n            let info = {\n                value: spitem.id,\n                label: spitem.name\n            };\n            specOptionsData.push(info);\n        }\n        return this.success(specOptionsData);\n    }\n    async getAllCategory1Action() { // 我写的算法\n        const model = this.model('category');\n        const data = await model.where({\n            is_show: 1,\n            level: 'L1'\n        }).select();\n        const c_data = await model.where({\n            is_show: 1,\n            level: 'L2'\n        }).select();\n        let newData = [];\n        for (const item of data) {\n            let children = [];\n            for (const citem of c_data) {\n                if (citem.parent_id == item.id) {\n                    children.push({\n                        value: citem.id,\n                        label: citem.name\n                    })\n                }\n            }\n            newData.push({\n                value: item.id,\n                label: item.name,\n                children: children\n            });\n        }\n        return this.success(newData);\n    }\n    async getAllCategoryAction() { // 晓玲的算法，她要\n        const model = this.model('category');\n        const data = await model.where({\n            is_show: 1,\n            level: 'L1'\n        }).field('id,name').select();\n        let newData = [];\n        for (const item of data) {\n            let children = [];\n            const c_data = await model.where({\n                is_show: 1,\n                level: 'L2',\n                parent_id: item.id\n            }).field('id,name').select();\n            for (const c_item of c_data) {\n                children.push({\n                    value: c_item.id,\n                    label: c_item.name\n                })\n            }\n            newData.push({\n                value: item.id,\n                label: item.name,\n                children: children\n            });\n        }\n        return this.success(newData);\n    }\n    async storeAction() {\n        const values = this.post('info');\n        const specData = this.post('specData');\n        const specValue = this.post('specValue');\n        const cateId = this.post('cateId');\n        const model = this.model('goods');\n        let picUrl = values.list_pic_url;\n        let goods_id = values.id;\n        values.category_id = cateId;\n        values.is_index = values.is_index ? 1 : 0;\n        values.is_new = values.is_new ? 1 : 0;\n        let id = values.id;\n        if (id > 0) {\n            await model.where({\n                id: id\n            }).update(values);\n            await this.model('cart').where({\n                goods_id: id\n            }).update({\n                checked: values.is_on_sale,\n                is_on_sale: values.is_on_sale,\n                list_pic_url: picUrl,\n                freight_template_id: values.freight_template_id\n            });\n            await this.model('product').where({\n                goods_id: id\n            }).update({\n                is_delete: 1\n            });\n            await this.model('goods_specification').where({\n                goods_id: id\n            }).update({\n                is_delete: 1\n            });\n            for (const item of specData) {\n                if (item.id > 0) {\n                    await this.model('cart').where({\n                        product_id: item.id,\n                        is_delete: 0,\n                    }).update({\n                        retail_price: item.retail_price,\n                        goods_specifition_name_value: item.value,\n                        goods_sn: item.goods_sn\n                    });\n                    delete item.is_delete;\n                    item.is_delete = 0;\n                    await this.model('product').where({\n                        id: item.id\n                    }).update(item);\n                    let specificationData = {\n                        value: item.value,\n                        specification_id: specValue,\n                        is_delete: 0\n                    };\n                    await this.model('goods_specification').where({\n                        id: item.goods_specification_ids\n                    }).update(specificationData);\n                } else {\n                    let specificationData = {\n                        value: item.value,\n                        goods_id: id,\n                        specification_id: specValue\n                    }\n                    let specId = await this.model('goods_specification').add(specificationData);\n                    item.goods_specification_ids = specId;\n                    item.goods_id = id;\n                    await this.model('product').add(item);\n                }\n            }\n        } else {\n            delete values.id;\n            goods_id = await model.add(values);\n            for (const item of specData) {\n                let specificationData = {\n                    value: item.value,\n                    goods_id: goods_id,\n                    specification_id: specValue\n                }\n                let specId = await this.model('goods_specification').add(specificationData);\n                item.goods_specification_ids = specId;\n                item.goods_id = goods_id;\n                item.is_on_sale = 1;\n                await this.model('product').add(item);\n            }\n        }\n        let pro = await this.model('product').where({\n            goods_id: goods_id,\n            is_on_sale: 1,\n            is_delete: 0\n        }).select();\n        if (pro.length > 1) {\n            let goodsNum = await this.model('product').where({\n                goods_id: goods_id,\n                is_on_sale: 1,\n                is_delete: 0\n            }).sum('goods_number');\n            let retail_price = await this.model('product').where({\n                goods_id: goods_id,\n                is_on_sale: 1,\n                is_delete: 0\n            }).getField('retail_price');\n            let maxPrice = Math.max(...retail_price);\n            let minPrice = Math.min(...retail_price);\n            let cost = await this.model('product').where({\n                goods_id: goods_id,\n                is_on_sale: 1,\n                is_delete: 0\n            }).getField('cost');\n            let maxCost = Math.max(...cost);\n            let minCost = Math.min(...cost);\n            let goodsPrice = '';\n            if(minPrice == maxPrice){\n                goodsPrice = minPrice;\n            }\n            else{\n                goodsPrice = minPrice + '~' + maxPrice;\n            }\n            let costPrice = minCost + '~' + maxCost;\n            await this.model('goods').where({\n                id: goods_id\n            }).update({\n                goods_number: goodsNum,\n                retail_price: goodsPrice,\n                cost_price: costPrice,\n                min_retail_price: minPrice,\n                min_cost_price: minCost,\n            });\n        } else {\n            let info = {\n                goods_number: pro[0].goods_number,\n                retail_price: pro[0].retail_price,\n                cost_price: pro[0].cost,\n                min_retail_price: pro[0].retail_price,\n                min_cost_price: pro[0].cost,\n            }\n            await this.model('goods').where({\n                id: goods_id\n            }).update(info);\n        }\n        return this.success(values);\n    }\n    async updatePriceAction() {\n        let data = this.post('');\n        // console.log(data);\n        await this.model('goods_specification').where({\n            id: data.goods_specification_ids\n        }).update({\n            value: data.value\n        });\n        await this.model('product').where({\n            id: data.id\n        }).update(data);\n        await this.model('cart').where({\n            product_id: data.id,\n            is_delete: 0,\n        }).update({\n            retail_price: data.retail_price,\n            goods_specifition_name_value: data.value,\n            goods_sn: data.goods_sn\n        });\n        delete data.value;\n        let goods_id = data.goods_id;\n        let pro = await this.model('product').where({\n            goods_id: goods_id,\n            is_on_sale: 1,\n            is_delete: 0\n        }).select();\n        if (pro.length > 1) {\n            let goodsNum = await this.model('product').where({\n                goods_id: goods_id,\n                is_on_sale: 1,\n                is_delete: 0\n            }).sum('goods_number');\n            let retail_price = await this.model('product').where({\n                goods_id: goods_id,\n                is_on_sale: 1,\n                is_delete: 0\n            }).getField('retail_price');\n            let maxPrice = Math.max(...retail_price);\n            let minPrice = Math.min(...retail_price);\n            let cost = await this.model('product').where({\n                goods_id: goods_id,\n                is_on_sale: 1,\n                is_delete: 0\n            }).getField('cost');\n            let maxCost = Math.max(...cost);\n            let minCost = Math.min(...cost);\n            let goodsPrice = '';\n            if(minPrice == maxPrice){\n                goodsPrice = minPrice;\n            }\n            else{\n                goodsPrice = minPrice + '~' + maxPrice;\n            }\n            let costPrice = minCost + '~' + maxCost;\n            await this.model('goods').where({\n                id: goods_id\n            }).update({\n                goods_number: goodsNum,\n                retail_price: goodsPrice,\n                cost_price: costPrice,\n                min_retail_price: minPrice,\n                min_cost_price: minCost,\n            });\n        } else {\n            let info = {\n                goods_number: pro[0].goods_number,\n                retail_price: pro[0].retail_price,\n                cost_price: pro[0].cost,\n                min_retail_price: pro[0].retail_price,\n                min_cost_price: pro[0].cost,\n            }\n            await this.model('goods').where({\n                id: goods_id\n            }).update(info);\n        }\n        return this.success();\n    }\n    async checkSkuAction() {\n        const info = this.post('info');\n        if (info.id > 0) {\n            const model = this.model('product');\n            const data = await model.where({\n                id: ['<>', info.id],\n                goods_sn: info.goods_sn,\n                is_delete: 0\n            }).find();\n            if (!think.isEmpty(data)) {\n                return this.fail(100, '重复')\n            } else {\n                return this.success();\n            }\n        } else {\n            const model = this.model('product');\n            const data = await model.where({\n                goods_sn: info.goods_sn,\n                is_delete: 0\n            }).find();\n            if (!think.isEmpty(data)) {\n                return this.fail(100, '重复')\n            } else {\n                return this.success();\n            }\n        }\n    }\n    async updateSortAction() {\n        const id = this.post('id');\n        const sort = this.post('sort');\n        const model = this.model('goods');\n        const data = await model.where({\n            id: id\n        }).update({\n            sort_order: sort\n        });\n        return this.success(data);\n    }\n    async updateShortNameAction() {\n        const id = this.post('id');\n        const short_name = this.post('short_name');\n        const model = this.model('goods');\n        const data = await model.where({\n            id: id\n        }).update({\n            short_name: short_name\n        });\n        return this.success(data);\n    }\n    async galleryListAction() {\n        const id = this.get('id');\n        const model = this.model('goods_gallery');\n        const data = await model.where({\n            goods_id: id,\n            is_delete:0\n        }).select();\n        // console.log(data);\n        return this.success(data);\n    }\n    async galleryAction() {\n        const url = this.post('url');\n        const id = this.post('goods_id');\n        let info = {\n            goods_id: id,\n            img_url: url\n        }\n        await this.model('goods_gallery').add(info);\n        return this.success();\n    }\n    async getGalleryListAction() {\n        const goodsId = this.post('goodsId');\n        const data = await this.model('goods_gallery').where({\n            goods_id: goodsId,\n            is_delete:0\n        }).select();\n        let galleryData = [];\n        for (const item of data) {\n            let pdata = {\n                id: item.id,\n                url: item.img_url\n            }\n            galleryData.push(pdata);\n        }\n        let info = {\n            galleryData: galleryData,\n        }\n        return this.success(info);\n    }\n    async deleteGalleryFileAction() {\n        const url = this.post('url');\n        const id = this.post('id');\n        await this.model('goods_gallery').where({\n            id: id\n        }).limit(1).update({\n            is_delete: 1\n        });\n        return this.success('文件删除成功');\n    }\n    async galleryEditAction() {\n        if (!this.isPost) {\n            return false;\n        }\n        const values = this.post();\n        let data = values.data;\n        // console.log(data);\n        const model = this.model('goods_gallery');\n        for (const item of data) {\n            let id = item.id;\n            let sort = parseInt(item.sort_order);\n            // console.log(sort);\n            await this.model('goods_gallery').where({\n                id: id\n            }).update({\n                sort_order: sort\n            });\n        }\n        return this.success();\n    }\n    async deleteListPicUrlAction() {\n        const id = this.post('id');\n        console.log(id);\n        await this.model('goods').where({\n            id: id\n        }).limit(1).update({\n            list_pic_url: 0\n        });\n        return this.success();\n    }\n    async destoryAction() {\n        const id = this.post('id');\n        await this.model('goods').where({\n            id: id\n        }).limit(1).update({\n            is_delete: 1\n        });\n        await this.model('product').where({\n            goods_id: id\n        }).update({\n            is_delete: 1\n        });\n        await this.model('goods_specification').where({\n            goods_id: id\n        }).update({\n            is_delete: 1\n        });\n        // TODO 删除图片\n        return this.success();\n    }\n    async uploadHttpsImageAction() {\n        let url = this.post('url');\n        console.log('----------------------');\n        console.log(url);\n        let accessKey = think.config('qiniuHttps.access_key');\n        let secretKey = think.config('qiniuHttps.secret_key');\n        let domain = think.config('qiniuHttps.domain');\n        var mac = new qiniu.auth.digest.Mac(accessKey, secretKey);\n        var config = new qiniu.conf.Config();\n        let zoneNum = think.config('qiniuHttps.zoneNum');\n        if(zoneNum == 0){\n            config.zone = qiniu.zone.Zone_z0;\n        }\n        else if(zoneNum == 1){\n            config.zone = qiniu.zone.Zone_z1;\n        }\n        else if(zoneNum == 2){\n            config.zone = qiniu.zone.Zone_z2;\n        }\n        else if(zoneNum == 3){\n            config.zone = qiniu.zone.Zone_na0;\n        }\n\n        else if(zoneNum == 4){\n            config.zone = qiniu.zone.Zone_as0;\n        }\n        var bucketManager = new qiniu.rs.BucketManager(mac, config);\n        let bucket = think.config('qiniuHttps.bucket');\n        let key = think.uuid(32);\n        await think.timeout(500);\n        const uploadQiniu = async() => {\n            return new Promise((resolve, reject) => {\n                try {\n                    bucketManager.fetch(url, bucket, key, function(err, respBody, respInfo) {\n                        if (err) {\n                            console.log(err);\n                            //throw err;\n                        } else {\n                            if (respInfo.statusCode == 200) {\n                                resolve(respBody.key)\n                            } else {\n                                console.log(respInfo.statusCode);\n                            }\n                        }\n                    });\n                } catch (e) {\n                    return resolve(null);\n                }\n            })\n        };\n        const httpsUrl = await uploadQiniu();\n        console.log(httpsUrl);\n        let lastUrl = domain + httpsUrl;\n        return this.success(lastUrl);\n    }\n};"
    ]
}